# 2022-05-04

### Today I Learned

- DB



#### DB

---

MySQL과 MongoDB

DB를 공부하다보면 자주 볼 수 있는 2가지다.

이번에는 SQL과 MongoDB의 특징 그리고 장단점에 대해 알아보려 한다.



#### SQL

---

SQL은 '구조화 된 쿼리 언어(Structured Query Language)'의 약자다.

이는 데이터베이스 자체는 나타내는 것이 아니라, 특정 유형의 데이터베이스와 상호 작용하는데 사용하는 쿼리 언어이다.

SQL을 사용하면 관계형 데이터베이스 관리 시스템(RDBMS)에서 데이터를 저장, 수정, 삭제 및  검색 할 수 있다.



RDBMS에는 2가지 주요 특징이 있다.

- 데이터는 정해진 데이터 스키마(structure)를 따라 데이터베이스 테이블에 저장된다.
- 데이터 관계를 통해서 연결된 여러개의 테이블에 분산된다.



##### 엄격한 스키마

---

데이터는 테이블(table)에 레코드(record)로 저장되며, 각 테이블에는 명확하게 저의된 구조가 있다.

구조(structure)란 어떤 데이터가 테이블에 들어가고 어떤 데이터가 그렇지 않은지 정의하는 필드(field) 집합을 가르킨다.

구조는 필드의 이름과 데이터 유형으로 정의된다.

RDBMS에서는 스키마를 준수하지 않는 레코드는 추가할 수 없다.



![img](https://t1.daumcdn.net/cfile/tistory/99BF063C5C937DF324)



##### 관계

---

SQL 기반의 데이터 베이스의 또 다른 중요한 부분은 관계이다.

데이터들을 여러개의 테이블에 누누어서, 데이터들의 중복을 피할 수 있다. 

![img](https://t1.daumcdn.net/cfile/tistory/994D09355C937ECD2D)

위의 사진은  관계를 살펴본 사진이다.

이런 명확한 구조는 하나의 테이블에서 중복없이 하나의 데이터만을 관리하기 때문에, 다른 테이블에서 부정확한 데이터를 다룰 위험이 없다.

이는 MongoDB를 보면 보다 명확히 이해할 수 있다.



##### 장,단점

---

- 장점
  - 명확하게 정의된 스키마, 데이터 무결성 보장
  - 관계는 각 데이터를 중복 없이 한번만 저장하게 해준다.
- 단점
  - 상대적으로 덜 유연하다. 데이터 스키마는 사전에 계획되고 알려져야한다.
  - 관계를 맺고 있기 때문에, JSON문이 많은 매우 복잡한 쿼리가 만들어질 수 있다.
  - 수평적 확장이 어렵고, 수직적 확장만 가능하다.



##### 언제 사용하는 것이 좋을까?

---

- 관계를 맺고 있는 데이터가 자주 변경되는 애플리케이션일 경우 
- 변경될 여지가 없고, 명확한 스키마가 사용자와 데이터에게 중요한 경우



#### NoSQL

---

NoSQL은 기본적으로 SQL과 반대되는 접근 방식을 따른다.

- 스키마 없음
- 관계 없음

NoSQL에서는 레코드를 문서(documents)라고 부른다.

SQL에서는 정해진 스키마를 따르지 않는다면 데이터를 추가 할 수 없지만, NoSQL에서는 다른 구조의 데이터를 같은 컬랙션(=SQL에서의 테이블)에 추가할 수 있다.

![img](https://t1.daumcdn.net/cfile/tistory/99FBC9415C937F2A20)

일반적으로 관련 데이터를 동일한 컬렉션에 넣는다.

RDBMS처럼 여러 테이블에 나누어 담지 않는다.

따라서 위의 사진의 많은 Order이 있는 경우, 일반적인 정보를 포함한 데이터를 Order 컬렉션에 저장한다.

RDBMS에서 사용했던 User나 Products 정보 또한 Orders에 포함해서 한꺼번에 저장되는 것이다.

이로인해 여러 테이블 / 콜렉션에 조인할 필요없이 필요한 모든 것을 갖춘 문서를 작성할 수 있는 것이다.

대신 컬렉션을 통해 데이터를 복제하여 각 컬렉션 일부분에 속하는 데이터를 정확하게 산출하도록 해야한다.

이런 방식은 데이터가 중복되기 때문에 불안정한 측면이 있다. 

특정 데이터를 같이 사용하는 모든 컬렉션에서, 똑같은 데이터 업데이트를 수행되도록 해야한다.

그럼에도 불구하고, 이러한 방식의 커다란 장점은 복잡한 조인을 사용할 필요가 없다는 것이다.

특히 자주 변경되지 않는 데이터 일때 더 큰 장점이 있다.



##### 장,단점

---

- 장점
  - 스키마가 없어 유연하다. 언제든지 저장된 데이터를 조정하고 새로운 '필드'를 추가할 수 있다.
  - 데이터는 애플리케이션이 필요로 하는 형식으로 저장된다. 이렇게 하면 데이터를 읽어오는 속도가 빨라진다.
  - 수직 및 수평적 확장이 가능하므로 데이터베이스가 애플리케이션에서 발생시키는 모든 읽기/쓰기 요청을 처리할 수 있다.
- 단점
  - 유연성 때문에, 데이터 구조 결정을 하지 못하고 미루게 될 수 있다.
  - 데이터가 여러 켈렉션에 중복되어 있기 때문에, 수정(update)를 해야하는 경우 모든 컬렉션에서 수행해야 함을 의미한다.



##### 언제 사용하는 것이 좋을까?

---

- 정확한 데이터 구조를 알 수 없거나 변경 / 확장 될 수 있는 경우
- 읽기(read) 처리를 자주하지만, 데이터를 자주 변경(update)하지 않는 경우
- 데이터베이스를 수평으로 확장해야 하는 경우



#### 수직적&수평적 확장

---

데이터베이스는 수직적(vertical) 확장과 수평적(horizontal) 확장으로 구별 할 수 있다.

- 수직적 확장이란 단순히 데이터베이스 서버의 성능을 향상시키는 것이다.
- 수평적 확장은 더 많은 서버가 추가되고 데이터베이스가 전체적으로 분산됨을 의미한다. 따라서 하나의 데이터베이스에서 작동하지만 여러 호스트에서 작동한다.

데이터가 저장되는 방식 때문에 SQL 데이터베이스는 일반적으로 수직적 확장만을 지원한다.

수평적 확장은 NoSQL 데이터베이스에서만 가능하다.



<details>
<summary>참고</summary>
<a href=https://siyoon210.tistory.com/130> https://siyoon210.tistory.com/130</a>
</details>
