# 2022-05-20

### Today I Learned

- localhostì—ì„œ https êµ¬í˜„í•˜ê¸°
  - mkcert
    - Chocolately




#### mkert

---



> mkcert is a simple tool for making locally-trusted development certificates. It requires no configuration.



mkcertëŠ” ë¡œì»¬ ê°œë°œ ì¸ì¦ì„œë¥¼ ë§Œë“¤ì–´ì£¼ëŠ” ë„êµ¬ì´ë‹¤.

ì´ëŠ” íŠ¹ë³„í•œ í™˜ê²½ì„¤ì •ì„ í•„ìš”ë¡œ í•˜ì§€ ì•ŠëŠ”ë‹¤.



mkcertë¥¼ window í™˜ê²½ì—ì„œ ì‚¬ìš©í•˜ë ¤ë©´ Chocolatelyë¥¼ ì´ìš©í•˜ì—¬ ì„¤ì¹˜í•˜ì—¬ì•¼ í•œë‹¤.



##### Chocolately

---

ìš°ì„  ChocolatelyëŠ” Linuxì—ì„œì˜ apt, yumì´ë‚˜ macOSì—ì„œì˜ Homebrewì²˜ëŸ¼ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜/ì—…ë°ì´íŠ¸/ì œê±° ë“± ê´€ë¦¬í•˜ëŠ” ë°ì— ì‚¬ìš©ë˜ëŠ” Windowìš© í”„ë¡œê·¸ë¨ì´ë‹¤.



Chocolatelyë¥¼ ì„¤ì¹˜í•˜ê¸° ìœ„í•´ì„œëŠ” powershellì„ ê´€ë¦¬ì ê¶Œí•œì„ í†µí•´ ì‹¤í–‰ì‹œì¼œ ì£¼ì–´ì•¼ í•œë‹¤.

ê·¸ëƒ¥ ì‹¤í–‰í•˜ê²Œ ë˜ë©´ ì„¤ì¹˜ê²½ë¡œì˜ ë³€ê²½ ë“±ì˜ ì‘ì—…ì´ ìš”êµ¬ëœë‹¤.



ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ powershellì„ ì‹¤í–‰í•˜ì˜€ìœ¼ë©´ ë‹¤ìŒì˜ ëª…ë ¹ì„ ì‹¤í–‰í•œë‹¤.

```cmd
Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
```



ì´í›„ ì¡°ê¸ˆì˜ ì‹œê°„ì´ ì§€ë‚˜ë©´ Chocolately ì„¤ì¹˜ê°€ ì™„ë£Œëœë‹¤.



##### ì¸ì¦ì„œ ë°œê¸‰

---

ìœ„ì™€ ê°™ì´ Chocolatelyë¥¼ ì„¤ì¹˜í•œ í›„ mkcertë¥¼ ì„¤ì¹˜í•œë‹¤.

```cmd
choco install mkcert
```



ì´ì œ mkcertë¥¼ í†µí•´ ë„ë©”ì¸ ì¸ì¦ì„œë¥¼ ë°œê¸‰í•œë‹¤.

```
 mkcert localhost
```



```
// ê²°ê³¼
Created a new certificate valid for the following names ğŸ“œ
 - "localhost"

The certificate is at "./localhost.pem" and the key at "./localhost-key.pem" âœ…

It will expire on 20 August 2024 ğŸ—“
```



ê·¸ ê²°ê³¼ ìœ„ì™€ ê°™ì€ í‚¤íŒŒì¼ localhost-key.pem ê·¸ë¦¬ê³  ì¸ì¦íŒŒì¼ localhost.pemì´ ìƒì„±ëœë‹¤.

ì´ íŒŒì¼ë“¤ì€ ì„œë²„ê°€ ì‹¤í–‰ë˜ëŠ” íŒŒì¼ê³¼ ê°™ì€ ìœ„ì¹˜ì— ìœ„ì¹˜ì‹œí‚¨ë‹¤.



#### https ì„œë²„ì— ì ìš©

---

ìš°ì„  http ì„œë²„ì™€ https ì„œë²„ë¥¼ ì ìš©í•  í¬íŠ¸ë¥¼ êµ¬ë¶„í•´ ì¤€ë‹¤.

```javascript
var http_port = process.env.HTTP_PORT;
var https_port = process.env.HTTPS_PORT;
```



ì´í›„ https ì„œë²„ë¥¼ ë§Œë“¤ ë•Œ ì˜µì…˜ì„ ì˜µì…˜ì„ ì„¤ì •í•œë‹¤.

```javascript
var https_options = { key: fs.readFileSync(path.join(__dirname+'/localhost-key.pem')), cert: fs.readFileSync(path.join(__dirname+'/localhost.pem')) };
```



ì´ì œ ë‹¤ìŒê³¼ ê°™ì´ https ì„œë²„ë¥¼ ë§Œë“ ë‹¤.

```javascript
https.createServer(https_options, app).listen(https_port, function() {
    logger.info (`${https_port} ì„œë²„ ê°€ë™`);
});
```

